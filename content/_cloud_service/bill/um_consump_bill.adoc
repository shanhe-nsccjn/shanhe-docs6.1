//消费账单

//概述
// tag::desc[]

消费账单提供了账单总览、消费明细及消费预估功能。
// end::desc[]

//账单总览
// tag::overview[]

您可以在**账单总览**页面查看每个账单期的账单概况，包括资源的消费情况及优惠券抵扣等信息，并支持导出选定时间范围内的账单。

image::/images/cloud_service/services/bill_center/bill_overview.png[账单总览]

* 查看账单：选择**对账周期**，页面即可显示对应周期内的账单消费情况，包括余额概览、账期充值概览、账期发票概览、账期消费概览。
* 导出账单：选择**对账周期**，点击**导出**，即可以 .xls 格式导出所选周期的账单数据。

// end::overview[]

// 消费明细
// tag::details[]

您可以在**消费明细**页面查看每月/季度/年/自定义时间的消费明细，并支持按照项目、资源类型、区域等多维度条件筛选查看。

image::/images/cloud_service/services/bill_center/consump_detail.png[消费明细]

* 查看消费明细：选择时间及过滤条件后，页面下方即可显示满足条件的消费统计图表，默认显示柱状图统计。在统计图右上方，可点击image:/images/cloud_service/services/bill_center/line_static.png[20px,20px]图标切换为折线图形式。
* 导出消费明细：在统计图右上角，点击**导出**，即可以 .xls 格式导出当前页面的消费统计数据。
// end::details[]

// 消费预估
// tag::forecast[]

消费预估根据您当前的按需资源、包年包月资源、即将产生续约操作的预留资源进行费用预估。您可以根据需求从多个维度查看费用预估。

== 查看消费预估
  
您可以在消费预估页面按条件筛选查看详细的预估费用。此外，您还可以在工作台页面、项目总览页面以及账户总览页面中查看默认预估时长内的消费预估。

=== 消费预估页面

. 进入link:../../entrance[费用中心]的**消费预估**页面。
+
image::/images/cloud_service/services/bill_center/consumption_forecast_new.png[]

. 根据需求，设置**预估的时间粒度**、**包年包月的预估逻辑**以及预估数据汇总分类，下方展示符合条件的预估数据。
+
例如：您需要查看未来 30 天内，各项目的按需资源消费预估及包年包月资源的分摊预估，则选择**预估的时间粒度**为 ``30天``，**包年包月的预估逻辑**为``按分摊``，预估数据汇总选择``按项目预估``。
+
image::/images/cloud_service/services/bill_center/consump_forecast_2.png[]
+
相关数据说明：
+
* 在按项目预估的统计中，包括了项目中目前所有资源的预估。如果一个合约内的资源属于多个项目，将根据项目将预留合约的费用进行拆分预估。
+
例如：用户有一个购买了 5 台包年包月的云服务器，其中 4 台属于项目 A，1 台属于项目 B，合约在 30 天内会到期自动续费，续费费用为 500 元，那项目 A 的这 4 台资源的预估为 400 元，项目 B 中这 1 台的预估为 100元。
* 在按账户预估的统计中，主账户可以查看主账户和非独立计费的子账户的资源或服务的预估情况，子账户仅可查看当前账户下所有的消费预估情况。
+
详细情况如下表：
+
image::/images/cloud_service/services/bill_center/forcast_detail.png[消费预估]


=== 账户总览页面

. 进入link:../../entrance[费用中心]的**账户总览**页面。

. 在**消费预估**区域，查看默认预估时长内的消费预估。
+
image::/images/cloud_service/services/bill_center/consump_forecast_1.png[]

. 点击**查看详情**，进入**消费预估**页面进行查看。

=== 工作台页面

. 在管理控制台的顶部菜单栏中，点击**工作台**进入工作台页面。
. 在消费预估区域，查看默认预估时长内的消费预估。
+
image::/images/cloud_service/services/bill_center/consump_forecast_3.png[]

=== 项目总览页面

. 在管理控制台的顶部菜单栏中，点击**项目**，选择想要查看的项目，默认进入**项目总览**页面。
. 在**消费预估**区域，查看默认预估时长内的消费预估。
+
项目的消费预估包含了项目目前所有资源的预估。
+
image::/images/cloud_service/services/bill_center/consump_forecast_4.png[]


== 配置默认预估参数

系统默认展示 7 天内的预估数据，您可以根据需求修改默认预估参数。修改后，消费预估页面、工作台页面、账户总览页面以及项目总览页面默认展示的预估数据将同步修改。

. 进入link:../../entrance[费用中心]的**消费预估**页面。
. 点击**默认预估参数配置**，弹出**默认预估参数配置**窗口。
+
image::/images/cloud_service/services/bill_center/consumption_forecast_setting.png[]
. 修改**预估的时间粒度**和**包年包月的预估逻辑**，点击**确定**。
+
[cols="1,3"]
|===
|参数|说明

|预估的时间粒度
|消费预估数据默认统计的时间粒度。 

|包年包月的预估逻辑
|包年包月/预留合约资源的消费预估逻辑。 +

支持**按实付**和**按分摊**两种预估逻辑，详细说明请参见<<note,预估逻辑说明>>。该参数仅影响包年包月/预留合约资源的消费预估，不影响按需计费资源的预估。按需计费资源的预估均为实付预估。

|===

[#note]
== 包年包月预估逻辑

包年包月预估逻辑支持**按实付**和**按分摊**两种。

=== 预估计算规则

* **按实付**：包年包月资源在预估期内需要实际支付的金额预估。
+
该逻辑下，预估值计算规则如下：
+
----
包年包月实付预估 = 待续约的支付金额
----

* *按分摊*：包年包月资源在预估期内的分摊金额预估。
+
该逻辑下，预估值计算规则分为两种情况：
+
----
1、包年包月分摊预估（自动续费） = 有效租赁期内的分摊 + 未来续费期内的分摊
2、包年包月分摊预估（非自动续费）= 有效租赁期内的分摊
----


=== 预估计算示例

*场景一*：

某用户在2023年1月1日购买了一个包年包月资源，有效期 1 年，付费 240 元，在2023年2月1日预估该资源在未来 30 天的消费。

image::/images/cloud_service/services/bill_center/forecast_eg_1.png[]

* 按实付预估：该资源在未来 30 天的实际支出为 0，所以实付预估消费为 0。
* 按分摊预估：该资源在未来 30 天的分摊预估 = 240/365*30（有效租赁期内的分摊预估）。


*场景二*：

某用户在2022年1月1日购买了一个包年包月资源，有效期 1 年，付费 240 元，资源到期后自动续费 1 个月，续费价格为 40 元/月，在2022年12月16日预估该资源在未来 30 天的消费。

image::/images/cloud_service/services/bill_center/forecast_eg_2.png[]

* 按实付预估：该资源在未来 30 天的预估支出为 40（自动续费预估），所以预估消费为 40。
* 按分摊预估：该资源在未来 30 天的分摊预估 = 240/365*15（有效租赁期内的分摊预估）+ 40/30*15（续费期内的分摊预估）。

*场景三*：

某用户在2022年1月1日购买了一个包年包月资源，有效期 1 年，付费 240 元，资源到期后不续费并销毁，在2022年12月16日预估该资源在未来 30 天的消费。

image::/images/cloud_service/services/bill_center/forecast_eg_3.png[]

* 按实付预估：该资源在未来 30 天的预估支出为 0（不续费），所以预估消费为 0。
* 按分摊预估：该资源在未来 30 天的分摊预估 = 240/365*15（有效租赁期内的分摊预估）。

*场景四*：

某用户在2022年1月1日购买了一个包年包月资源，有效期 1 年，付费 240 元，资源到期后转为按需计费，按需计费价格为 1元/天，在2022年12月16日预估该资源在未来 30 天的消费。

image::/images/cloud_service/services/bill_center/forecast_eg_4.png[]

* 按实付预估：该资源在未来 30 天的总消费预估 = 0（有效租赁期内的实付预估） + 15*1（到期后15天的实付预估）。
* 按分摊预估：该资源在未来 30 天的总消费预估 = 240/365*15（有效租赁期内的分摊预估）+ 15*1（到期后15天的按需实付预估）。

// end::forecast[]

